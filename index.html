<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Adam’s Leeragenda</title>
  <meta name="color-scheme" content="light only">
  <!-- Tailwind for utility classes -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- React + ReactDOM UMD -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <!-- Firebase compat (Auth + Firestore) -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>

<script>
  window.FIREBASE_CONFIG = {
    apiKey: "AIzaSyDeyau613TAvys5iV8S11PmFhcSxECtaVY",
    authDomain: "leeragenda.firebaseapp.com",
    projectId: "leeragenda",
    storageBucket: "leeragenda.appspot.com",
    messagingSenderId: "996121641435",
    appId: "1:996121641435:web:fb553773e99bf8bc6b67fe",
    measurementId: "G-2SV73NZ5D3"
  };
</script>

  -->
  <style>
    :root{
      --lightGreen:#A7F3D0; --darkYellow:#D97706; --cyanBlue:#06B6D4;
      --ink:#0F172A; --slate:#334155;
    }
    body{ background: linear-gradient(135deg, #ffffff 0%, #E9FFF6 45%, #E8FAFF 100%); }
    .glass{ background: rgba(255,255,255,.8); backdrop-filter: saturate(1.2) blur(8px);
            -webkit-backdrop-filter: saturate(1.2) blur(8px); border:1px solid rgba(148,163,184,.25); }
    .input{ border-radius:.9rem; border:1px solid #E2E8F0; padding:.65rem .9rem; outline:none; }
    .input:focus{ border-color:#06B6D4; box-shadow:0 0 0 3px rgba(6,182,212,.25); }
    .btn{ border-radius:.9rem; padding:.6rem 1rem; font-weight:700; transition: transform .05s ease, filter .2s ease; }
    .btn:active{ transform: scale(.99); }
    .btn-prim{ color:#fff; background-image: linear-gradient(180deg,#06B6D4,#0891B2); box-shadow:0 4px 16px rgba(6,182,212,.35); }
    .btn-sec{ background:#F1F5F9; color:#334155; }
    .chip{ border-radius:999px; padding:.25rem .625rem; font-size:.75rem; font-weight:600; display:inline-block; }
    .col{ min-width:240px; max-width:320px; }
    .task-card{ border-width:2px; transition: box-shadow .2s ease, transform .06s ease; }
    .task-card:hover{ box-shadow:0 6px 22px rgba(2,132,199,.12); }
    .task-card:active{ transform: scale(.99); }
    .shadow-soft{ box-shadow:0 10px 30px rgba(2,132,199,.06), 0 2px 10px rgba(15,23,42,.06); }
  </style>
</head>
<body class="min-h-screen text-slate-800">
  <div id="root"></div>
  <script>
  // --- Core state helpers ---
  const COLORS={ lightGreen:"#A7F3D0", darkYellow:"#D97706", cyanBlue:"#06B6D4", dark:"#0F172A", mid:"#334155", light:"#F8FAFC" };
  const SUBJECTS=["Aardrijkskunde","Geschiedenis","Nederlands","Latijn","Wiskunde","Frans","Engels","Biologie"];
  const SUBJECT_COLORS={Aardrijkskunde:COLORS.cyanBlue,Geschiedenis:COLORS.darkYellow,Nederlands:COLORS.lightGreen,Latijn:COLORS.cyanBlue,Wiskunde:COLORS.darkYellow,Frans:COLORS.lightGreen,Engels:COLORS.cyanBlue,Biologie:COLORS.darkYellow};
  const STORAGE_KEY="adam-leeragenda-v2";

  function startOfWeek(date){ const d=new Date(date); const day=(d.getDay()+6)%7; d.setHours(0,0,0,0); d.setDate(d.getDate()-day); return d; }
  function formatISODate(d){ const z=n=> String(n).padStart(2,"0"); return `${d.getFullYear()}-${z(d.getMonth()+1)}-${z(d.getDate())}`; }
  function parseISODate(s){ const [y,m,d]=s.split("-").map(Number); return new Date(y,m-1,d); }
  </script>

  <script>
  // --- Minimal React code (zonder Babel) ---
  const { useEffect, useMemo, useState, useRef } = React;

  function useFirebaseSync(weekKey){
    const [enabled, setEnabled] = useState(!!window.FIREBASE_CONFIG);
    const [status, setStatus] = useState("offline"); // offline | verbinden | online
    const [remoteTasks, setRemoteTasks] = useState(null);
    const writeTimer = useRef(null);
    const docRef = useRef(null);

    useEffect(()=>{
      if(!enabled || !window.FIREBASE_CONFIG){ setStatus("offline"); return; }
      try{
        if (!firebase.apps.length) firebase.initializeApp(window.FIREBASE_CONFIG);
        const db = firebase.firestore();
        firebase.auth().signInAnonymously().then(cred => {
          const uid = cred.user.uid; setStatus("verbinden");
          docRef.current = db.collection("boards").doc(uid).collection("weeks").doc(weekKey);
          return docRef.current.get().then(snap => {
            if (!snap.exists) return docRef.current.set({ tasks: [], updated: Date.now() });
          }).then(()=>{
            return docRef.current.onSnapshot(snap => {
              const data = snap.data() || {tasks:[]};
              setRemoteTasks(data.tasks);
              setStatus("online");
            });
          });
        }).catch(()=> setStatus("offline"));
      } catch(e){ setStatus("offline"); }
    }, [enabled, weekKey]);

    function scheduleWrite(tasks){
      if (!docRef.current) return;
      if (writeTimer.current) clearTimeout(writeTimer.current);
      writeTimer.current = setTimeout(()=>{
        docRef.current.set({ tasks, updated: Date.now() }, { merge: true });
      }, 350);
    }

    return { enabled, setEnabled, status, remoteTasks, scheduleWrite };
  }

  function App(){
    const [weekStart, setWeekStart] = useState(startOfWeek(new Date()));
    const weekKey = formatISODate(weekStart);
    const { enabled: cloudEnabled, setEnabled: setCloudEnabled, status, remoteTasks, scheduleWrite } = useFirebaseSync(weekKey);

    const [tasks, setTasks] = useState([]);
    const [filterSubject, setFilterSubject] = useState("Alle vakken");
    const [showDone, setShowDone] = useState(true);
    const [draggingId, setDraggingId] = useState(null);
    const [search, setSearch] = useState("");
    const [showNewTask, setShowNewTask] = useState(false);
    const [editingTask, setEditingTask] = useState(null);
    const [defaultPlanDate, setDefaultPlanDate] = useState(formatISODate(weekStart));

    useEffect(()=>{
      const saved = localStorage.getItem(STORAGE_KEY);
      if(saved){ try{ setTasks(JSON.parse(saved).tasks || []);} catch{ setTasks([]);} }
    },[]);
    useEffect(()=> setDefaultPlanDate(formatISODate(weekStart)), [weekStart]);

    // cloud -> local on change
    useEffect(()=>{
      if (cloudEnabled && Array.isArray(remoteTasks)){
        setTasks(remoteTasks);
        localStorage.setItem(STORAGE_KEY, JSON.stringify({ tasks: remoteTasks }));
      }
    }, [cloudEnabled, remoteTasks]);

    // local -> storage (+ cloud if enabled)
    useEffect(()=>{
      localStorage.setItem(STORAGE_KEY, JSON.stringify({tasks}));
      if (cloudEnabled) scheduleWrite(tasks);
    }, [tasks]);

    const days = useMemo(()=> Array.from({length:7}).map((_,i)=>{ const d=new Date(weekStart); d.setDate(weekStart.getDate()+i); return d; }), [weekStart]);
    const filteredTasks = useMemo(()=> tasks.filter(t=>{
      const okS = filterSubject==="Alle vakken" || t.subject===filterSubject;
      const okQ = !search || t.title.toLowerCase().includes(search.toLowerCase());
      return okS && okQ && (showDone || !t.done);
    }), [tasks, filterSubject, search, showDone]);

    function tasksForDate(dateISO){ return filteredTasks.filter(t=>t.plannedDate===dateISO); }
    function addTask(newTask){ setTasks(prev=> [{...newTask, id: crypto.randomUUID(), done:false}, ...prev]); }
    function updateTask(id, patch){ setTasks(prev=> prev.map(t=> t.id===id? {...t, ...patch}: t)); }
    function deleteTask(id){ setTasks(prev=> prev.filter(t=> t.id!==id)); }
    function duplicateTask(id){ const t=tasks.find(x=>x.id===id); if(!t) return; const copy={...t, id: crypto.randomUUID(), done:false}; setTasks(prev=> [copy, ...prev]); }
    function moveTaskToNextDay(id){ const t=tasks.find(x=>x.id===id); if(!t) return; const next=parseISODate(t.plannedDate); next.setDate(next.getDate()+1); updateTask(id, { plannedDate: formatISODate(next) }); }
    function clearDoneInWeek(){ const isoRange=days.map(d=>formatISODate(d)); setTasks(prev=> prev.filter(t=> !(t.done && isoRange.includes(t.plannedDate)))); }
    function totalMinutesForDate(dateISO){ return tasksForDate(dateISO).reduce((s,t)=> s + (t.estimate||0), 0); }

    function handleDragStart(e,id){ setDraggingId(id); e.dataTransfer.setData("text/plain", id); e.dataTransfer.effectAllowed="move"; }
    function handleDrop(dateISO,e){ e.preventDefault(); const id=e.dataTransfer.getData("text/plain")||draggingId; if(!id) return; updateTask(id,{plannedDate:dateISO}); setDraggingId(null); }

    function DayHeader({ d }){
      const dateISO = formatISODate(d);
      const weekday = d.toLocaleDateString(undefined,{weekday:"long"});
      const dayNum = d.getDate();
      const month = d.toLocaleDateString(undefined,{month:"short"});
      const minutes = totalMinutesForDate(dateISO);
      const hours = Math.floor(minutes/60);
      const mins = minutes % 60;
      return (
        React.createElement('div', {className:'flex items-center justify-between px-4 pt-3 pb-2'}, [
          React.createElement('div', {key:'w', className:'text-[11px] md:text-xs tracking-wide uppercase text-slate-500'}, weekday),
          React.createElement('div', {key:'d', className:'flex items-baseline gap-1.5'}, [
            React.createElement('span', {key:'n', className:'text-lg md:text-xl font-extrabold text-slate-800'}, dayNum),
            React.createElement('span', {key:'m', className:'text-[11px] md:text-sm text-slate-500'}, month)
          ]),
          React.createElement('div', {key:'t', className:'text-[11px] text-slate-500'}, `Totaal: ${hours>0? hours+' u':''} ${mins} min`)
        ])
      );
    }

    function SubjectPill({ subject }){
      const color = SUBJECT_COLORS[subject] || COLORS.mid;
      return React.createElement('span', {className:'chip', style:{background: color+'22', color}}, subject);
    }

    function TaskCard({ task }){
      const border = SUBJECT_COLORS[task.subject] || COLORS.mid;
      return React.createElement('div', {
        className:'task-card group rounded-3xl p-3 mb-3 bg-white border flex flex-col gap-2 cursor-grab active:cursor-grabbing hover:shadow-soft',
        style:{borderColor: border},
        draggable:true,
        onDragStart:(e)=>handleDragStart(e, task.id)
      }, [
        React.createElement('div', {key:'r', className:'flex items-start gap-2'}, [
          React.createElement('input', {key:'c', type:'checkbox', className:'mt-1 h-4 w-4', checked:task.done, onChange:(e)=>updateTask(task.id,{done:e.target.checked})}),
          React.createElement('div', {key:'b', className:'flex-1'}, [
            React.createElement('div', {key:'t', className:'flex items-center justify-between gap-2'}, [
              React.createElement('div', {key:'ti', className:`font-semibold ${task.done? 'line-through text-slate-400':'text-slate-800'}`}, task.title),
              React.createElement(SubjectPill, {key:'p', subject:task.subject})
            ]),
            React.createElement('div', {key:'m', className:'flex flex-wrap items-center gap-2 text-xs text-slate-500 mt-1'}, [
              React.createElement('span', {key:'type', className:'px-1.5 py-0.5 rounded bg-slate-100'}, task.type || 'Huiswerk'),
              task.estimate? React.createElement('span', {key:'est'}, `± ${task.estimate} min`) : null,
              task.dueDate? React.createElement('span', {key:'due'}, `Deadline: ${new Date(task.dueDate).toLocaleDateString()}`) : null
            ]),
            task.notes? React.createElement('div', {key:'no', className:'text-xs text-slate-600 mt-2'}, task.notes) : null,
            React.createElement('div', {key:'ac', className:'flex justify-end flex-wrap gap-2 mt-2 opacity-0 group-hover:opacity-100 transition'}, [
              React.createElement('button', {key:'n', className:'text-xs px-2 py-1 rounded bg-slate-100 hover:bg-slate-200', onClick:()=>moveTaskToNextDay(task.id)}, 'Naar morgen'),
              React.createElement('button', {key:'k', className:'text-xs px-2 py-1 rounded bg-slate-100 hover:bg-slate-200', onClick:()=>duplicateTask(task.id)}, 'Kopieer'),
              React.createElement('button', {key:'b', className:'text-xs px-2 py-1 rounded bg-slate-100 hover:bg-slate-200', onClick:()=>setEditingTask(task)}, 'Bewerken'),
              React.createElement('button', {key:'v', className:'text-xs px-2 py-1 rounded bg-rose-100 hover:bg-rose-200 text-rose-700', onClick:()=>deleteTask(task.id)}, 'Verwijder')
            ])
          ])
        ])
      ]);
    }

    function NewTaskFormAuto({ onAdd, onClose, defaultDate }){
      const [title,setTitle]=useState(''); const [subject,setSubject]=useState(SUBJECTS[0]);
      const [type,setType]=useState('Huiswerk'); const [estimate,setEstimate]=useState(25);
      const [plannedDate,setPlannedDate]=useState(defaultDate); const [dueDate,setDueDate]=useState(''); const [notes,setNotes]=useState('');
      const [distribute,setDistribute]=useState(true); const [perMinutes,setPerMinutes]=useState(25); const [skipWeekend,setSkipWeekend]=useState(false);
      const [addReviews,setAddReviews]=useState(true); const [reviewMinutes,setReviewMinutes]=useState(10); const [reviewPattern,setReviewPattern]=useState('1,3,7');

      function allDatesInclusive(startISO,endISO){
        const dates=[]; let d=parseISODate(startISO); const end=parseISODate(endISO);
        while(d<=end){ const isW=d.getDay()===0||d.getDay()===6; if(!(skipWeekend && isW)) dates.push(formatISODate(d)); d=new Date(d.getTime()); d.setDate(d.getDate()+1); }
        return dates;
      }

      function submit(e){
        e.preventDefault(); if(!title.trim()) return;
        if(distribute){
          if(!dueDate) return alert('Kies een deadline om te kunnen verdelen.');
          const start=parseISODate(plannedDate), end=parseISODate(dueDate); if(end<start) return alert('Deadline ligt vóór de plandag.');
          const dates=allDatesInclusive(plannedDate,dueDate);
          dates.forEach((iso,idx)=> onAdd({ title:`${title} (${idx+1}/${dates.length})`, subject, type, estimate:Number(perMinutes)||0, plannedDate:iso, dueDate, notes }));
          if(addReviews){
            const lastStudy=parseISODate(dates[dates.length-1]); const end=parseISODate(dueDate);
            reviewPattern.split(',').map(s=>parseInt(s.trim(),10)).filter(n=>Number.isFinite(n)&&n>0).forEach((off,i)=>{
              const d=new Date(lastStudy); d.setDate(d.getDate()+off);
              if(d<=end) onAdd({ title:`${title} – herhaling (${i+1})`, subject, type:'Herhaling', estimate:Number(reviewMinutes)||10, plannedDate:formatISODate(d), dueDate, notes });
            });
          }
        } else {
          onAdd({ title, subject, type, estimate:Number(estimate)||0, plannedDate, dueDate, notes });
        }
        onClose();
      }

      return React.createElement('div',{className:'fixed inset-0 z-50 bg-black/40 flex items-center justify-center p-4'},
        React.createElement('div',{className:'w-full max-w-xl rounded-3xl glass shadow-soft'},
          [
            React.createElement('div',{key:'h',className:'p-5 border-b border-slate-200/50 flex items-center justify-between'},
              [React.createElement('div',{key:'t',className:'text-lg font-semibold'},'Nieuwe taak'),
               React.createElement('button',{key:'x',className:'text-slate-500 hover:text-slate-700',onClick:onClose},'✕')]
            ),
            React.createElement('form',{key:'f',onSubmit:submit,className:'p-5 grid grid-cols-1 md:grid-cols-2 gap-4'},[
              inputField('Titel', React.createElement('input',{className:'input',value:title,onChange:e=>setTitle(e.target.value),placeholder:'Bijv. hoofdstuk 1 leren'})),
              inputField('Vak', React.createElement('select',{className:'input',value:subject,onChange:e=>setSubject(e.target.value)}, SUBJECTS.map(s=>React.createElement('option',{key:s,value:s},s)))),
              inputField('Soort', React.createElement('select',{className:'input',value:type,onChange:e=>setType(e.target.value)}, ['Huiswerk','Leerwerk','Project','Overig'].map(s=>React.createElement('option',{key:s},s)))),
              null, /* tijd (alleen zichtbaar als distribute uit staat) */
              inputField('Plandag', React.createElement('input',{className:'input',type:'date',value:plannedDate,onChange:e=>setPlannedDate(e.target.value)})),
              inputField('Deadline (toetsdatum)', React.createElement('input',{className:'input',type:'date',value:dueDate,onChange:e=>setDueDate(e.target.value)})),
              React.createElement('div',{key:'dist',className:'md:col-span-2 rounded-2xl border border-slate-200/70 p-3'},[
                React.createElement('label',{key:'l',className:'flex items-center gap-2 text-sm'},[
                  React.createElement('input',{key:'cb',type:'checkbox',checked:distribute,onChange:e=>setDistribute(e.target.checked)}),'Verdeel dagelijks t/m de deadline'
                ]),
                distribute? React.createElement('div',{key:'g',className:'mt-3 grid grid-cols-1 md:grid-cols-3 gap-3 items-end'},[
                  inputField('Minuten per dag', React.createElement('input',{className:'input',type:'number',min:5,value:perMinutes,onChange:e=>setPerMinutes(e.target.value)})),
                  React.createElement('label',{key:'we',className:'flex items-center gap-2 text-sm'},[
                    React.createElement('input',{type:'checkbox',checked:skipWeekend,onChange:e=>setSkipWeekend(e.target.checked)}),'Weekend overslaan'
                  ]),
                  React.createElement('div',{key:'hint',className:'text-xs text-slate-500'},'Titels als (1/N).')
                ]) : null
              ]),
              React.createElement('div',{key:'rev',className:'md:col-span-2 rounded-2xl border border-slate-200/70 p-3'},[
                React.createElement('div',{key:'h',className:'text-sm font-medium mb-2'},'Herhaling'),
                React.createElement('label',{key:'l',className:'flex items-center gap-2 text-sm'},[
                  React.createElement('input',{type:'checkbox',checked:addReviews,onChange:e=>setAddReviews(e.target.checked)}),'Herhaling toevoegen (1,3,7)'
                ]),
                addReviews? React.createElement('div',{key:'g',className:'mt-3 grid grid-cols-1 md:grid-cols-3 gap-3'},[
                  inputField('Minuten/sessie', React.createElement('input',{className:'input',type:'number',min:5,value:reviewMinutes,onChange:e=>setReviewMinutes(e.target.value)})),
                  inputField('Patroon (dagen na laatste leerdag)', React.createElement('input',{className:'input',value:reviewPattern,onChange:e=>setReviewPattern(e.target.value),placeholder:'bijv. 1,3,7'}),'md:col-span-2')
                ]) : null
              ]),
              inputField('Notities', React.createElement('textarea',{className:'input min-h-[80px]',value:notes,onChange:e=>setNotes(e.target.value)}),'md:col-span-2'),
              React.createElement('div',{key:'actions',className:'md:col-span-2 flex justify-end gap-2 pt-2'},[
                React.createElement('button',{type:'button',className:'btn btn-sec',onClick:onClose},'Annuleren'),
                React.createElement('button',{type:'submit',className:'btn btn-prim'},'Toevoegen')
              ])
            ])
          ])
        )
      );
    }

    function inputField(label, control, extraClass){
      return React.createElement('label',{className:`flex flex-col gap-1 text-sm ${extraClass||''}`},[
        React.createElement('span',{key:'s'},label),
        React.createElement(React.Fragment,{key:'c'},control)
      ]);
    }

    function EditTaskForm({ task, onClose, onSave, onDelete, onRedistribute }){
      const [title,setTitle]=useState(task.title); const [subject,setSubject]=useState(task.subject);
      const [type,setType]=useState(task.type||'Huiswerk'); const [estimate,setEstimate]=useState(task.estimate||25);
      const [plannedDate,setPlannedDate]=useState(task.plannedDate); const [dueDate,setDueDate]=useState(task.dueDate||''); const [notes,setNotes]=useState(task.notes||'');
      const [perMinutes,setPerMinutes]=useState(25); const [skipWeekend,setSkipWeekend]=useState(false);

      return React.createElement('div',{className:'fixed inset-0 z-50 bg-black/40 flex items-center justify-center p-4'},
        React.createElement('div',{className:'w-full max-w-xl rounded-3xl glass shadow-soft'},[
          React.createElement('div',{key:'h',className:'p-5 border-b border-slate-200/50 flex items-center justify-between'},[
            React.createElement('div',{key:'t',className:'text-lg font-semibold'},'Taak bewerken'),
            React.createElement('button',{key:'x',className:'text-slate-500 hover:text-slate-700',onClick:onClose},'✕')
          ]),
          React.createElement('div',{key:'f',className:'p-5 grid grid-cols-1 md:grid-cols-2 gap-4'},[
            inputField('Titel', React.createElement('input',{className:'input',value:title,onChange:e=>setTitle(e.target.value)})),
            inputField('Vak', React.createElement('select',{className:'input',value:subject,onChange:e=>setSubject(e.target.value)}, SUBJECTS.map(s=>React.createElement('option',{key:s,value:s},s)))),
            inputField('Soort', React.createElement('select',{className:'input',value:type,onChange:e=>setType(e.target.value)}, ['Huiswerk','Leerwerk','Project','Overig','Herhaling'].map(s=>React.createElement('option',{key:s},s)))),
            inputField('Tijd (minuten)', React.createElement('input',{className:'input',type:'number',min:0,value:estimate,onChange:e=>setEstimate(e.target.value)})),
            inputField('Plandag', React.createElement('input',{className:'input',type:'date',value:plannedDate,onChange:e=>setPlannedDate(e.target.value)})),
            inputField('Deadline', React.createElement('input',{className:'input',type:'date',value:dueDate,onChange:e=>setDueDate(e.target.value)})),
            inputField('Notities', React.createElement('textarea',{className:'input min-h-[80px]',value:notes,onChange:e=>setNotes(e.target.value)}),'md:col-span-2'),
            React.createElement('div',{key:'rd',className:'md:col-span-2 grid grid-cols-1 md:grid-cols-3 gap-3 border-t pt-3'},[
              inputField('Herverdeel: min/dag', React.createElement('input',{className:'input',type:'number',min:5,value:perMinutes,onChange:e=>setPerMinutes(e.target.value)})),
              React.createElement('label',{key:'we',className:'flex items-center gap-2 text-sm'},[
                React.createElement('input',{type:'checkbox',checked:skipWeekend,onChange:e=>setSkipWeekend(e.target.checked)}),'Weekend overslaan'
              ]),
              React.createElement('button',{key:'btn',className:'btn btn-sec self-end',onClick:()=>onRedistribute({ perMinutes, skipWeekend })},'Herverdeel tussen plandag en deadline')
            ]),
            React.createElement('div',{key:'ac',className:'md:col-span-2 flex justify-between items-center pt-2'},[
              React.createElement('button',{className:'text-rose-700 bg-rose-100 hover:bg-rose-200 rounded-xl px-3 py-2',onClick:onDelete},'Verwijder taak'),
              React.createElement('div',{className:'flex gap-2'},[
                React.createElement('button',{className:'btn btn-sec',onClick:onClose},'Annuleren'),
                React.createElement('button',{className:'btn btn-prim',onClick:()=>onSave({ title, subject, type, estimate:Number(estimate)||0, plannedDate, dueDate, notes })},'Opslaan')
              ])
            ])
          ])
        ])
      );
    }

    const weeklyBySubject = (tasks, days)=>{
      const isoRange = days.map(d=>formatISODate(d));
      const result = {}; SUBJECTS.forEach(s=> result[s]={done:0,total:0});
      for (const t of tasks){ if(!isoRange.includes(t.plannedDate)) continue; const r=result[t.subject]||(result[t.subject]={done:0,total:0}); r.total+=1; if(t.done) r.done+=1; }
      return result;
    };

    return React.createElement('div',{style:{fontFamily:'Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial'}},[
      // Header
      React.createElement('header',{key:'hd',className:'sticky top-0 z-40 border-b border-slate-200/60 bg-white/80 backdrop-blur'},[
        React.createElement('div',{key:'in',className:'max-w-[1400px] mx-auto px-4 py-3 flex items-center gap-3'},[
          React.createElement('div',{key:'logo',className:'w-9 h-9 rounded-2xl',style:{background: COLORS.cyanBlue}}),
          React.createElement('div',{key:'t',className:'flex-1'},[
            React.createElement('h1',{key:'h1',className:'text-xl md:text-2xl font-extrabold tracking-tight'},'Adam’s Leeragenda'),
            React.createElement('p',{key:'p',className:'text-xs text-slate-500'},'Plan, verdeel, herhaal. Overal beschikbaar.')
          ]),
          React.createElement('div',{key:'btns',className:'hidden md:flex items-center gap-2'},[
            React.createElement('button',{className:'btn btn-sec',onClick:()=>{const d=new Date(weekStart); d.setDate(d.getDate()-7); setWeekStart(d);}},'Vorige week'),
            React.createElement('button',{className:'btn btn-sec',onClick:()=> setWeekStart(startOfWeek(new Date()))},'Deze week'),
            React.createElement('button',{className:'btn btn-sec',onClick:()=>{const d=new Date(weekStart); d.setDate(d.getDate()+7); setWeekStart(d);}},'Volgende week'),
            React.createElement('button',{className:'btn btn-prim',onClick:()=> setShowNewTask(true)},'Nieuwe taak')
          ]),
          React.createElement('div',{key:'sync',className:'flex items-center gap-2'},[
            React.createElement('span',{className:`inline-flex items-center gap-1 text-xs rounded-full px-2 py-1 ${status==='online'?'bg-green-100 text-green-600': status==='verbinden'?'bg-amber-100 text-amber-700':'bg-slate-100 text-slate-600'}`},[
              React.createElement('span',{className:`w-2 h-2 rounded-full ${status==='online'?'bg-green-500': status==='verbinden'?'bg-amber-500':'bg-slate-400'}`}), status
            ]),
            React.createElement('label',{className:'text-xs flex items-center gap-1'},[
              React.createElement('input',{type:'checkbox',checked:cloudEnabled,onChange:e=>setCloudEnabled(e.target.checked)}),'Cloud sync'
            ])
          ])
        ]),
        React.createElement('div',{key:'m',className:'md:hidden px-4 pb-3 flex gap-2'},[
          React.createElement('button',{className:'btn btn-sec',onClick:()=>{const d=new Date(weekStart); d.setDate(d.getDate()-7); setWeekStart(d);}},'←'),
          React.createElement('button',{className:'btn btn-sec',onClick:()=> setWeekStart(startOfWeek(new Date()))},'Vandaag'),
          React.createElement('button',{className:'btn btn-sec',onClick:()=>{const d=new Date(weekStart); d.setDate(d.getDate()+7); setWeekStart(d);}},'→'),
          React.createElement('button',{className:'btn btn-prim flex-1',onClick:()=> setShowNewTask(true)},'Nieuwe taak')
        ])
      ]),
      // Main
      React.createElement('main',{key:'mn',className:'max-w-[1400px] mx-auto px-4 pt-4 pb-10'},[
        React.createElement('div',{className:'grid grid-cols-1 lg:grid-cols-4 gap-4'},[
          // Board
          React.createElement('section',{key:'board',className:'lg:col-span-3'},[
            React.createElement('div',{key:'controls',className:'mb-3 flex flex-wrap items-center gap-2'},[
              React.createElement('select',{className:'input',value:filterSubject,onChange:e=>setFilterSubject(e.target.value)},[
                React.createElement('option',{key:'all'},'Alle vakken'),
                ...SUBJECTS.map(s=> React.createElement('option',{key:s},s))
              ]),
              React.createElement('label',{className:'flex items_CENTER gap-2 text-sm text-slate-600'},[
                React.createElement('input',{type:'checkbox',checked:showDone,onChange:e=>setShowDone(e.target.checked)}),'Toon afgeronde taken'
              ]),
              React.createElement('input',{className:'input flex-1 min-w-[180px]',placeholder:'Zoeken...',value:search,onChange:e=>setSearch(e.target.value)}),
              React.createElement('button',{className:'btn btn-sec',onClick:clearDoneInWeek},'Wis afgerond (deze week)')
            ]),
            React.createElement('div',{key:'sc',className:'overflow-x-auto pb-2'},[
              React.createElement('div',{key:'grid',className:'grid grid-flow-col auto-cols-[minmax(240px,1fr)] gap-3 min-w-[1000px]'},
                days.map(d=>{
                  const dateISO = formatISODate(d);
                  return React.createElement('div',{key:dateISO,className:'col rounded-[28px] glass shadow-soft min-h-[220px] flex flex-col',
                    onDragOver:e=>e.preventDefault(), onDrop:e=>handleDrop(dateISO,e)},[
                      React.createElement(DayHeader,{key:'h', d}),
                      React.createElement('div',{key:'l',className:'px-3 pb-3 flex-1'},
                        tasksForDate(dateISO).map(t=> React.createElement(TaskCard,{key:t.id, task:t}))
                      ),
                      React.createElement('div',{key:'a',className:'px-3 pb-3'},
                        React.createElement('button',{className:'w-full text-sm rounded-xl border border-dashed border-cyan-300 py-2 hover:bg-cyan-50', onClick:()=>{setDefaultPlanDate(dateISO); setShowNewTask(true);}},'+ Taak toevoegen')
                      )
                    ]);
                })
              )
            ])
          ]),
          // Sidebar
          React.createElement('aside',{key:'sb',className:'lg:col-span-1 space-y-4'},[
            React.createElement('div',{key:'stats',className:'rounded-[28px] glass shadow-soft p-4'},[
              React.createElement('h2',{className:'text-base font-semibold'},'Voortgang per vak (deze week)'),
              React.createElement('div',{className:'mt-3 space-y-2'},
                SUBJECTS.map(s=>{
                  const res = weeklyBySubject(tasks, days)[s] || {done:0,total:0};
                  const pct = res.total? Math.round((res.done/res.total)*100) : 0;
                  return React.createElement('div',{key:s},[
                    React.createElement('div',{className:'flex items-center justify-between text-sm'},[
                      React.createElement('span',{className:'flex items-center gap-2'},[
                        React.createElement('span',{className:'inline-block w-2.5 h-2.5 rounded-full',style:{background: SUBJECT_COLORS[s] || COLORS.mid}}), s
                      ]),
                      React.createElement('span',{className:'text-slate-500'}, `${res.done}/${res.total}`)
                    ]),
                    React.createElement('div',{className:'mt-1 h-2 rounded-full bg-slate-100 overflow-hidden'},
                      React.createElement('div',{className:'h-full',style:{width: pct+'%', background: SUBJECT_COLORS[s] || COLORS.mid}})
                    )
                  ]);
                })
              )
            ]),
            React.createElement('div',{key:'qa',className:'rounded-[28px] glass shadow-soft p-4'},[
              React.createElement('h2',{className:'text-base font-semibold'},'Snel toevoegen'),
              React.createElement(QuickAdd,{onAdd:(t)=>addTask(t), defaultDate:formatISODate(weekStart)}),
              React.createElement('p',{className:'text-[11px] text-slate-500 mt-3'},'Tip: plan kleine blokken en laat herhaling automatisch inplannen.')
            ])
          ])
        ]),
        React.createElement('footer',{className:'mt-6 text-xs text-slate-400'},'Tip: maak kleine, haalbare stappen. Elke dag een beetje werkt beter dan alles tegelijk.')
      ]),
      showNewTask? React.createElement(NewTaskFormAuto,{defaultDate:defaultPlanDate,onAdd:t=>addTask(t),onClose:()=>setShowNewTask(false)}): null,
      editingTask? React.createElement(EditTaskForm,{task:editingTask,onClose:()=>setEditingTask(null),
        onSave:(patch)=>{ updateTask(editingTask.id, patch); setEditingTask(null); },
        onDelete:()=>{ deleteTask(editingTask.id); setEditingTask(null); },
        onRedistribute:({perMinutes=25, skipWeekend=false})=>{
          const t=editingTask; if(!t.dueDate || !t.plannedDate){ alert('Kies plandag en deadline.'); return; }
          const start=parseISODate(t.plannedDate), end=parseISODate(t.dueDate); if(end<start){ alert('Deadline ligt vóór de plandag.'); return; }
          let dates=[]; let d=new Date(start);
          while(d<=end){ const isW=d.getDay()===0||d.getDay()===6; if(!(skipWeekend && isW)) dates.push(formatISODate(d)); d=new Date(d.getTime()); d.setDate(d.getDate()+1); }
          dates.forEach((iso,idx)=> addTask({ title:`${t.title} (${idx+1}/${dates.length})`, subject:t.subject, type:t.type||'Huiswerk', estimate:Number(perMinutes)||0, plannedDate:iso, dueDate:t.dueDate, notes:t.notes||'' }));
          deleteTask(t.id); setEditingTask(null);
        }}) : null
    ]);
  }

  function QuickAdd({ onAdd, defaultDate }){
    const [title,setTitle]=React.useState(''); const [subject,setSubject]=React.useState(SUBJECTS[0]); const [minutes,setMinutes]=React.useState(20);
    function submit(){ if(!title.trim()) return; onAdd({ title, subject, type:'Huiswerk', estimate:Number(minutes)||0, plannedDate: defaultDate, dueDate:'', notes:'' }); setTitle(''); }
    return React.createElement('div',{className:'flex flex-col gap-2'},[
      React.createElement('input',{className:'input',placeholder:'Titel',value:title,onChange:e=>setTitle(e.target.value)}),
      React.createElement('div',{className:'flex gap-2'},[
        React.createElement('select',{className:'input flex-1',value:subject,onChange:e=>setSubject(e.target.value)}, SUBJECTS.map(s=> React.createElement('option',{key:s},s))),
        React.createElement('input',{className:'input w-28',type:'number',min:0,value:minutes,onChange:e=>setMinutes(e.target.value)})
      ]),
      React.createElement('button',{className:'btn btn-prim',onClick:submit},'Toevoegen')
    ]);
  }

  ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(App));
  </script>
</body>
</html>
